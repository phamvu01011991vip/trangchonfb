<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Phân UID cho từng người — Chia đều</title>
  <style>
    :root{--bg:#f7fafc;--card:#fff;--muted:#6b7280}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#111}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;gap:16px;align-items:center}
    h1{margin:0;font-size:20px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    textarea{width:80%; max-width: 100%;min-height:90px;padding:10px;border:1px solid #e5e7eb;border-radius:8px;font-family:monospace}
    input[type=text]{padding:8px;border-radius:6px;border:1px solid #e5e7eb}
    button{background:#111;color:#fff;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
    .grid{display:grid;grid-template-columns:1fr 2fr;gap:18px;margin-top:18px}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 1px 4px rgba(15,23,42,0.06)}
    .people-list{display:flex;flex-wrap:wrap;gap:8px}
    .person{padding:8px 10px;border-radius:8px;background:#eef2ff;border:1px solid #e0e7ff;cursor:pointer}
    .assignments{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .person-card{background:linear-gradient(180deg,#fff,#fafafa);padding:12px;border-radius:10px;border:1px solid #eef2ff}
    .person-card h3{margin:0 0 8px 0;font-size:16px}
    .uid-list{font-family:monospace;font-size:13px;white-space:pre-wrap}
    .tools{display:flex;gap:8px;flex-wrap:wrap}
    .small{padding:6px 8px;font-size:13px}
    .muted{color:var(--muted)}
    body {
      background-image: url(./1.jpg);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1 style="color: red;background-color: #111;">Campuchia: Nơi để anh em kiếm tiền không phải nơi để anh em đi du lịch, nghỉ dưỡng</h1>
        <div style="color: rgb(255, 0, 0); font-weight: bold; background-color: #111; margin-top: 20px;" class="muted">Không chọn được thì sẽ được tặng combo: cắt tóc + cạo râu + gõ phím + checkin đi du lịch</div>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <label class="muted">Danh sách UID:</label>
        <textarea id="uids">
100004313504328
100005041685418
100005617508611
100006465195344
100006497029147
100007353664928
100007808168919
100007848616798
100008373150299
100008404923553
100008508492464
100008837160329
100009082865302
100009504642631
100009713085000
100009867542290
100009893854535
100010290047796
100010308492372
100010318754333
100010358793581
100010729519504
100010774297314
100011026202286
100011183839405
100011207957044
100011538187605
100011702438135
100011958798629
100012439633921
100012526127688
100012648215450
100012670457857
100012842286618
100013139192996
100013231500735
100013594057414
100013675696278
100014374691618
100014558078228
100014692625894
100015002058702
100015025391744
100015165167414
100015299436332
100015396311770
100015678349344
100016089576435
100016440014064
100016615448359
100017035861573
100017109498071
100017203531871
100017536569314
100018461526916
100021527169126
100021545299925
100021708156138
100021886652833
100022016020572
100022197920483
100022371062240
100022440167717
100022831717808
100023262630522
100023467158177
100023522271238
100023670164183
100023787843024
100023909865139
100025022733180
100025259137382
100025270571683
100025286898953
100025357542905
100025396952483
100025400738504
100025473241186
100025896200942
100025897223114
100026231926505
100026294164571
100026371909001
100026690503086
100026756556250
100027063349702
100027097429552
100027110795833
100027392465198
100027416880854
100027524543748
100027609695422
100027642141845
100027970220827
100028011225782
100028098378052
100028194013522
100028309029967
100028602428057
100028813727387
100029204534865
100029261710152
100029355966541
100029862890626
100030460389755
100030701621337
100030850538174
100031139744189
100031575443723
100031802866750
100032371082042
100032479388362
100032976585308
100033202464334
100033271039991
100033297691468
100033479344454
100033654499368
100033854564069
100034019330480
100034053660379
100034236700844
100034523989176
100034793139453
100034820109864
100034994391591
100035087766167
100035126299117
100035929245751
100036106788422
100036166984611
100036251112188
100036263149758
100036285903862
100036650033449
100036956314657
100037115723846
100037294741382
100037426608705
100037587196029
100037648123934
100038365746156
100038617844536
100038980399395
100039089184327
100039595420888
100039835274057
100040109712991
100041007070400
100041207652579
100041250000795
100041760463414
100042006787851
100042272436801
100042281783858
100042356502644
100042439481195
100042458736394
100043098131938
100043427824982
100043864096495
100043889149393
100044036345805
100044923473104
100045365747903
100045367069416
100045473861458
100045474640950
100045881625437
100046025393590
100046091151197
100046108112212
100046455481451
100046643438427
100046760507398
100047203742142
100048401062200
100048829054650
100048953831599
100048988021009
100049347469259
100049667227405
100049847983276
100050221756310
100050385726628
100050477231465
100050512531864
100050846295223
100051131353871
100051505002618
100051647106201
100052129364373
100052140690714
100052198187623
100052373854413
100052576809145
100052720146527
100052844163128
100052991869465
100053289784193
100053318300785
100053789975794
100054157932083
100054399253459
100054468990002
100055058798759
100055145412399
100055310401523
100055620109491
100055736229359
100056118541528
100056724020796
100056760130027
100057010211490
100057442746096
100057489301878
100058557635312
100058788780649
100059712847331
100060662237118
100061641762263
100063767287509
100063788570858
100064405012120
100064557471021
100064671482422
100064852864558
100065523060169
100066711276504
100067448873105
100068251934900
100068320413315
100068321624523
100068531477791
100068553251365
100069139497197
100069821298402
100070138098062
100070195642023
100070640357507
100070711087358
100072111506874
100072381330809
100073156487126
100073629051134
100073927922699
100074128135117
100074304533196
100074896701656
100074933030083
100075169282136
100075172581358
100076121081750
100076683287701
100077336393439
100078262966997
100078826991162
100080221159026
100080502275746
100081072780696
100081342845211
100081350455531
100081529073991
100081913220631
100083574802263
100083875820325
100083980781884
100083993505216
100084001683363
100084517566487
100084704514642
100084770935472
100084908891287
100086165440737
100086444727973
100086744902706
100087060754835
100087077516205
100087205752287
100087451133273
100088233277259
100088408423110
100088440450519
100088698593639
100089258889310
100089296130814
100089876512438
100090012006029
100090235224993
100090493372804
100090755943933
100090865459459
100090961927593
100090971042935
100091062324193
100091389262480
100091455871627
100091583073673
100091738184984
100092293150075
100092298814983
100092701625438
100092757881878
100092834930039
100093119883548
100093164013598
100093174147337
100093207878566
100093349914336
100093361193882
100093399997397
100093448966265
100093455634883
100094094688222
100094408604656
100094682645358
100094708542733
100094989352389
100095413938091
61550023317960
61550059986171
61550212760608
61550285228876
61550293890664
61550294723876
61550330232561
61550342717589
61550487232740
61550492712563
61550531889009
61550552190181
61550556682753
61550572089361
61550596254606
61550621483163
61550630511428
61550728404332
61550794216891
61550799839305
61550824686496
61550908768640
61550926281063
61550936248417
61550937603971
61550945826419
61550963567668
61551014516825
61551021553136
61551036965563
61551097311764
61551147360274
61551343410817
61551351032020
61551439408321
61551519503861
61551582765266
61551601782040
61551614456241
61551620395220
61551647131628
61551675825614
61551796036051
61551863115459
61551871743728
61551940367515
61551983068585
61551985824296
61552023364879
61552044777051
61552105002681
61552173087289
61552194912580
61552350323476
61552352039813
61552401967315
61552512477331
61552554896941
61552612375305
61552614002963
61552618808203
61552633460908
61552748738421
61552757429558
61552791283276
61552812894876
61552901140016
61552996667099
61553001626621
61553050486485
61553087941346
61553158869049
61553177894779
61553242928463
61553253862389
61553390520786
61553394204695
61553450566266
61553450939521
61553476318540
61553491364920
61553659775383
61553677598489
61553686660929
61553690890860
61553698920478
61553840714273
61553843501478
61553845575964
61553887681895
61553895855716
61553934904541
61553938932957
61553947387539
61553962597025
61553988706823
61554005236246
61554037355459
61554086611119
61554097997979
61554101944187
61554103869265
61554123715075
61554131113615
61554146462194
61554177700226
61554225330762
61554266063178
61554277981849
61554286301072
61554335789570
61554339808977
61554414736193
61554425146507
61554478216276
61554557408113
61554617594820
61554692365208
61554737952667
61554765496191
61554780272627
61554872828987
61554878281201
61554882520286
61554905213330
61554909447475
61554925005826
61554983651183
61555002840402
61555013947822
61555019195552
61555037705828
61555050590251
61555123628470
61555153681253
61555186772953
61555192949536
61555209091870
61555233535819
61555235582231
61555237561498
61555238011528
61555333042581
61555358039675
61555373592760
61555411584018
61555417503221
61555473735037
61555491304498
61555517044623
61555521814487
61555537487661
61555552760078
61555587422642
61555590156413
61555599344532
61555610439351
61555651529803
61555716901216
61555759903863
61555839586975
61555902971265
61555904667140
61555913758370
61555947192504
61555956471704
61556002746110
61556069450173
61556142435486
61556188735437
61556194886733
61556199337145
61556213993586
61556253880540
61556329476047
61556330601342
61556518794007
61556540301329
61556578910319
61556586163877
61556625892081
61556638540813
61556677866027
61556692197913
61556696506698
61556698541672
61556727361169
61556728832822
61556775428842
61556788611082
61556815777479
61556845678513
61556852953061
61556886495217
61556896211047
61556897864020
61556908198167
61556940507144
61556967641350
61556986711348
61557019341903
61557038417740
61557040420098
61557070731850
61557091355253
61557131549791
61557154304791
61557216111847
61557238645716
61557274986173
61557288463566
61557288766978
61557289996958
61557303699975
61557316965590
61557323170417
61557386486298
61557404532236
61557409662128
61557420238865
61557422263414
61557440941740
61557441984246
61557459939884
61557462522784
61557466995754
61557499595195
61557522931445
61557543964534
61557572437807
61557578740201
61557617160076
61557617457002
61557625192069
61557688421179
61557700256832
61557714200013
61557741363309
61557764798734
61557770540055
61557782684148
61557791974762
61557818704335
61557840350409
61557844180625
61557846810404
61557848589315
61557869259427
61557885500824
61557895718003
61557913304883
61557918602773
61557923122477
61557926410480
61557939029904
61557955716984
61557956038578
61557963587521
61557989369152
61557992174362
61557998894508
61558001200218
61558022763742
61558036642021
61558056730597
61558057432644
61558066846227
61558070824278
61558071427462
61558074221287
61558117498326
61558142263888
61558167036724
61558185750858
61558206832985
61558211159107
61558245958817
61558258583430
61558309892095
61558310046829
61558380940765
61558393767928
61558485668104
61558508774342
61558523510977
61558597357206
61558614357932
61558644164651
61558667240799
61558671116210
61558800715813
61558847330454
61558976534941
61559002263938
61559021405932
61559046996215
61559061632806
61559077680876
61559123978931
61559130762141
61559159519296
61559183603707
61559196132121
61559199710089
61559227246959
61559227254193
61559261604428
61559341111289
61559346385010
61559347330186
61559380634768
61559448060336
61559472550527
61559491311108
61559505837050
61559550836898
61559564077295
61559572895792
61559579706103
61559585166098
61559595718604
61559604963549
61559620841838
61559625812067
61559658246651
61559660536371
61559675938879
61559682930362
61559692680212
61559697391658
61559741005150
61559743626160
61559744375537
61559759637617
61559761250725
61559773345549
61559776511818
61559781573132
61559787881296
61559804174107
61559809244842
61559857212530
61559864435939
61559879030946
61559903684446
61559910556976
61559915783682
61559947897344
61559986354373
61559989523839
61560006483158
61560010845165
61560030101597
61560039448086
61560042215698
61560071881049
61560089396358
61560116127029
61560131101262
61560225372398
61560250476952
61560272759135
61560288789669
61560296204906
61560303555625
61560313013227
61560337751055
61560352176415
61560371844985
61560394947561
61560422787422
61560508531042
61560561418723
61560562708422
61560566835721
61560576041645
61560582787961
61560619861582
61560624304676
61560637927049
61560640114671
61560652443599
61560660584868
61560665114007
61560671893068
61560688258191
61560709078571
61560746726656
61560754664746
61560780161674
61560780313126
61560781633497
61560788187825
61560796203763
61560826919966
61560846815122
61560853707627
61560877114417
61560886529491
61560892794710
61560903355044
61560943274386
61560957393928
61560965897753
61561006880316
61561041861841
61561058071239
61561101912706
61561123530007
61561126061769
61561131387895
61561145376008
61561149145521
61561154455476
61561191643368
61561193335633
61561197323581
61561214036108
61561258681025
61561264195386
61561267422502
61561281865849
61561343155831
61561378966287
61561382564367
61561386615295
61561395704180
61561426748433
61561456411925
61561469115169
61561516565321
61561558276951
61561560610906
61561571073202
61561579418258
61561584600792
61561590507545
61561596927957
61561623157826
61561659790295
61561674952338
61561700002108
61561706699780
61561717467469
61561726855347
61561737561017
61561758382477
61561772744550
61561779317603
61561833494815
61561878410135
61561903061538
61561911066332
61561914173740
61561934840070
61561942122850
61561948286663
61561958633243
61561966574203
61561993769573
61562017738132
61562073873056
61562085125795
61562107240694
61562112849976
61562148715708
61562168706339
61562191101493
61562251082721
61562287834482
61562324703387
61562340716885
61562345249210
61562380919018
61562408231278
61562409057441
61562424674169
61562441571220
61562493020375
61562541012023
61562546347556
61562550309669
61562554644226
61562560013826
61562594600614
61562617176613
61562637819098
61562652042900
61562661517925
61562747166053
61562787596058
61562791112196
61562856371282
61562864535354
61562964314997
61562975612114
61562999896375
61563012612466
61563045033744
61563067725253
61563069663195
61563123391302
61563127581571
61563145227662
61563239272348
61563243735627
61563257876646
61563276697586
61563289590699
61563315580490
61563351465001
61563370899232
61563386303370
61563413491314
61563414898325
61563497914398
61563586290142
61563601634151
61563614297388
61563617015680
61563624644113
61563627544462
61563662754646
61563677083623
61563719540348
61563769974044
61563791093213
61563796178601
61563816460663
61563839265557
61563853209397
61563860434107
61563868800315
61563886935942
61563888266132
61563889386587
61563940983978
61563976959457
61563983572066
61563987450296
61564006617424
61564008970913
61564010996051
61564040270124
61564057762694
61564062242843
61564067030904
61564070220880
61564070261502
61564071490272
61564116745863
61564122440265
61564128052393
61564134268972
61564157583559
61564196803426
61564219642539
61564223521054
61564243726809
61564249094608
61564273397241
61564278472134
61564278509272
61564278587983
61564278628542
61564292261327
61564304504066
61564310497314
61564324046154
61564333404499
61564394303280
61564396812475
61564417526741
61564424511739
61564427681772
61564430380635
61564431403288
61564461336642
61564497366811
61564533872065
61564575935072
61564582943803
61564615229928
61564629261714
61564650968932
61564664649174
61564776029666
61564811627066
61564873257267
61564878114457
61564878201690
61564908264319
61564946213983
61564949784912
61564989594995
61565010607614
61565080505870
61565088452192
61565094290349
61565106644516
61565147488824
61565150841351
61565156516922
61565228297712
61565248029428
61565279563355
61565345752677
61565371300781
61565412663510
61565423622725
61565441102325
61565442190357
61565443496567
61565510116079
61565555897211
61565630140158
61565657363597
61565659966239
61565673453556
61565682474042
61565711939366
61565726777044
61565761979986
61565779584280
61565795699378
61565801863177
61565829860655
61565838315693
61565864085630
61565937010156
61565946483807
61565950182522
61565966140607
61566134226544
61566203614510
61566246010856
61566305138555
61566362317663
61566382774480
61566428727231
61566539393122
61566543269117
61566569902186
61566604784241
61566708954243
61566753251229
61566809948005
61566853366913
61566855220821
61566865629746
61566902987540
61566980855360
61567069192084
61567097288910
61567118589128
61567149553734
61567150691369
61567214614421
61567252406895
61567272659721
61567293594296
61567376423334
61567395693700
61567409387082
61567430289686
61567435706544
61567464742487
61567500165449
61567639253378
61567686126498
61567687424735
61567758218612
61567792040436
61567809310911
61567813812068
61567818932563
61567854098093
61567929512331
61567973585761
61568046873509
61568101607541
61568192668086
61568295920607
61568368761630
61568376021603
61568381570774
61568386717897
61568406822537
61568411744108
61568577779446
61568631032234
61569503317547
61569874416235
61569946852937
61570316254019
61570948686543
61574873747251
61574875275526
        </textarea>

        <div style="height:10px"></div>
        <label class="muted">Danh sách người (phân tách bằng dấu phẩy):</label>
        <input id="people" type="text" value="hoàng nam,nguyễn hương,việt anh,quang huy,tô lâm, phạm văn, đức dương, phan kiên, thiện trí, khẩn, long, hào, cường  " />

        <div class="controls">
          <button id="distribute">Phân đều</button>
          <button id="clear" class="small">Xóa phân bố</button>
          <button id="copyAll" class="small">Sao chép toàn bộ JSON</button>
          <button id="exportCsv" class="small">Xuất CSV</button>
          <div style="flex:1"></div>
        </div>

        <div style="margin-top:12px" class="muted">Bác Hồ đã nói "Không có việc gì khó, chỉ sợ lòng không bền, đào núi và lấp biển, quyết chí ắt làm nên"</div>
      </div>

      <div class="card">
        <h3>Kết quả phân bổ</h3>
        <div id="summary" class="muted">Chưa phân bổ</div>
        <div style="height:12px"></div>
        <div id="assignments" class="assignments"></div>
      </div>
    </div>

  </div>

  <script>
    // Utility
    function parseUIDs(text){
      // split on whitespace or commas
      return text.split(/\s+|,+/).map(s=>s.trim()).filter(Boolean);
    }
    function parsePeople(text){
      return text.split(/,+/).map(s=>s.trim()).filter(Boolean);
    }

    function distribute(uids, people){
      // ensure stable distribution even if fewer people than uids or vice versa
      const n = people.length;
      const result = {};
      people.forEach(p=> result[p]=[]);
      if(n===0){ return result; }
      // round-robin assignment
      for(let i=0;i<uids.length;i++){
        const p = people[i % n];
        result[p].push(uids[i]);
      }
      return result;
    }

    function render(assignments){
      const container = document.getElementById('assignments');
      container.innerHTML = '';
      const people = Object.keys(assignments);
      let total=0; let min=Infinity,max=-Infinity;
      people.forEach(p=>{
        const list = assignments[p];
        total += list.length;
        min = Math.min(min, list.length);
        max = Math.max(max, list.length);
      });
      if(people.length===0){ document.getElementById('summary').textContent = 'Không có người để phân bổ'; return; }
      document.getElementById('summary').textContent = `Tổng UID: ${total} — Người: ${people.length} — mỗi người nhận: ${min} đến ${max}`;

      people.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'person-card';
        const h = document.createElement('h3');
        h.textContent = `${p} (${assignments[p].length})`;
        card.appendChild(h);

        const btns = document.createElement('div'); btns.className='tools';
        const copyBtn = document.createElement('button'); copyBtn.className='small'; copyBtn.textContent='Sao chép';
        copyBtn.onclick = ()=>{ navigator.clipboard.writeText(assignments[p].join('\n')).then(()=> alert('Đã sao chép')) }
        const exportBtn = document.createElement('button'); exportBtn.className='small'; exportBtn.textContent='Xuất CSV';
        exportBtn.onclick = ()=>{ downloadCSV([[ 'name','uid' ], ...assignments[p].map(u=>[p,u])], `${p.replace(/\s+/g,'_')}.csv`) }
        btns.appendChild(copyBtn); btns.appendChild(exportBtn);
        card.appendChild(btns);

        const pre = document.createElement('div'); pre.className='uid-list'; pre.textContent = assignments[p].join('\n');
        card.appendChild(pre);
        container.appendChild(card);
      });
    }

    function downloadCSV(rows, filename){
      const lines = rows.map(r=> r.map(cell => '"' + String(cell).replaceAll('"','""') + '"').join(',')).join('\n');
      const blob = new Blob([lines], {type:'text/csv;charset=utf-8;'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      link.remove();
    }

    // DOM hookups
    document.getElementById('distribute').addEventListener('click', ()=>{
      const uidsRaw = document.getElementById('uids').value;
      const peopleRaw = document.getElementById('people').value;
      const uids = parseUIDs(uidsRaw);
      const people = parsePeople(peopleRaw);
      const assignments = distribute(uids, people);
      render(assignments);
      // store latest to window for export/copy
      window.latestAssignments = assignments;
    });

    document.getElementById('clear').addEventListener('click', ()=>{
      document.getElementById('assignments').innerHTML = '';
      document.getElementById('summary').textContent = 'Đã xóa phân bổ';
      window.latestAssignments = null;
    });

    document.getElementById('copyAll').addEventListener('click', ()=>{
      if(!window.latestAssignments){ alert('Chưa có phân bổ. Bấm Phân đều trước'); return; }
      navigator.clipboard.writeText(JSON.stringify(window.latestAssignments, null, 2)).then(()=> alert('Đã sao chép JSON'))
    });

    document.getElementById('exportCsv').addEventListener('click', ()=>{
      if(!window.latestAssignments){ alert('Chưa có phân bổ. Bấm Phân đều trước'); return; }
      // combine into rows [name,uid]
      const rows = [['name','uid']];
      Object.entries(window.latestAssignments).forEach(([name,uids])=>{
        uids.forEach(u=> rows.push([name,u]));
      });
      downloadCSV(rows, 'phan_bo_uid.csv');
    });

    // auto-distribute on load
    document.getElementById('distribute').click();
  </script>
</body>
</html>