<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Phân UID cho từng người — Chia đều</title>
  <style>
    :root{--bg:#f7fafc;--card:#fff;--muted:#6b7280}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#111}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;gap:16px;align-items:center}
    h1{margin:0;font-size:20px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    textarea{width:80%; max-width: 100%;min-height:90px;padding:10px;border:1px solid #e5e7eb;border-radius:8px;font-family:monospace}
    input[type=text]{padding:8px;border-radius:6px;border:1px solid #e5e7eb}
    button{background:#111;color:#fff;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
    .grid{display:grid;grid-template-columns:1fr 2fr;gap:18px;margin-top:18px}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 1px 4px rgba(15,23,42,0.06)}
    .people-list{display:flex;flex-wrap:wrap;gap:8px}
    .person{padding:8px 10px;border-radius:8px;background:#eef2ff;border:1px solid #e0e7ff;cursor:pointer}
    .assignments{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .person-card{background:linear-gradient(180deg,#fff,#fafafa);padding:12px;border-radius:10px;border:1px solid #eef2ff}
    .person-card h3{margin:0 0 8px 0;font-size:16px}
    .uid-list{font-family:monospace;font-size:13px;white-space:pre-wrap}
    .tools{display:flex;gap:8px;flex-wrap:wrap}
    .small{padding:6px 8px;font-size:13px}
    .muted{color:var(--muted)}
    body {
      background-image: url(./1.jpg);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1 style="color: red;background-color: #111;">Campuchia: Nơi để anh em kiếm tiền không phải nơi để anh em đi du lịch, nghỉ dưỡng</h1>
        <div style="color: rgb(255, 0, 0); font-weight: bold; background-color: #111; margin-top: 20px;" class="muted">Không chọn được thì sẽ được tặng combo: cắt tóc + cạo râu + gõ phím + checkin đi du lịch</div>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <label class="muted">Danh sách UID:</label>
        <textarea id="uids">
100087313133241
100015233404692
100012110530501
100050405112273
100030845678138
100060715868512
100018967384076
100024759617707
100035681478696
100034138369042
100024046036336
100064995030658
100044945980328
100013314152874
100053798139602
100016941312424
100037991643299
100024787133784
100036396406190
100095039456126
100033656790080
100039015767963
100028897099426
100040536940734
100068085641910
100046911291359
100038775202565
100009361339460
100023031438318
100034813503942
100075462363894
100090828030921
100029255540033
100009612882765
100034332184070
100017856636119
100042944582397
100041000089824
100071081619546
100045026028155
100029762052731
100050649829733
100011501286114
100041051911589
100019292966949
100079943254448
100042190080974
100007694204561
100080400589987
100034249790735
100062892287734
100022969065831
100058748443323
100023199454452
100058388185904
100033902671099
100034108660753
100050162538266
100078249282637
100019922956416
100006067097283
100023205757932
100089742942568
100045357420186
100087466233839
100045324620848
100032162387233
100057121125816
100055534314268
100063963772535
100038239008647
100084420430854
100068434628506
100092718439781
100041547641956
100022854464810
100011000591649
100090630227354
100045696642689
100079616755330
100092195392842
100038625081052
100023502376478
100014011728716
100019451263216
100016539639133
100059549627220
100035134148147
100061459622526
100053356029565
100004903967970
100014952369116
100089830773950
100041010042712
100086058597476
100080206123725
100023952069710
100027089859674
100027747767671
100035339269372
100041471597860
100024682330356
100038515146697
100042216270740
100070773347404
100023170967506
100043598023058
100061192236155
100025365802024
100070366524377
100051277246011
100090826657890
100087960103283
100041466553433
100015279967386
100085179231017
100031521579122
100013934431695
100078072217247
100050123927540
100014069080504
100059752723374
100008935509561
100028753463357
100015390375852
100033810891440
100035595937427
100013862921157
100078963346149
100053472499623
100073297515551
100048129232770
100047248771031
100094840969136
100033426666357
100087650867575
100048767861796
100051102646744
100012044683131
100064620940085
100015332406202
100025295658766
100024943934788
100030218117696
100071720272833
100033486379780
100030753550696
100022925234294
100024290288215
100010843446423
100083713543230
100027266404321
100038774804402
100024025923192
100022847170545
100050815543985
100067163670489
100025408566045
100058556089413
100025393961117
100014869095442
100033295991546
100077396075833
100023832251339
100022676776047
100050285049932
100023155583868
100092546191964
100034665493519
100011587683518
100072669367494
100076946225293
100029774032485
100022673315882
100009367006245
100013843631701
100057090166297
100055183591414
100084043471950
100012246880911
100024538740550
100013810240917
100015365525699
100093976451623
100010437961679
100043401724617
100018374596898
61553064729856
100037310109845
100095121073293
100016323104595
100094170831468
100026048948804
100083110437063
100026304560858
100011456424564
100027038569803
100045673130554
100074166699197
100015993391502
100070844791474
100027119179441
100041960436222
100010354173211
100082825939052
100016423209201
100088167824783
100012992530753
100082320357824
100014408463821
100004161403750
100052013092353
100050058184561
100024945532789
100041305052955
100032709606937
100004005680401
100028114040775
100057463913999
100043906964756
100018132304752
100092182615712
100092448673352
100014152420870
100038346728501
100065776480585
100040617372209
100000846913454
100043742050206
100064478622177
100036968086430
100064255746082
100089874480187
100011352324830
100050180656993
100017792296071
100083967715539
100050093834819
100056046386048
100038404954706
100022816160233
100065565405753
100037083666167
100084369664852
100011213409747
100022104855882
100046910504879
100078290875347
100054646026889
100013648996139
100025684171650
100085657093872
100026602208946
100035813796254
100050671448395
100011154494915
100015156908529
100018467176451
100074569145284
100003009687992
100012583531355
100017591915975
100043594792993
100052093728870
100045787397644
100033244669234
100077256429345
100052066220647
100034654293875
100008335121832
100080265829703
100050663173123
100021794472323
100034091985733
100038810232653
100044134413188
100004490598350
100052100654653
100022178500329
100034796940666
100008911694284
61558390282029
100037994557653
100076923247406
100052906178580
100063432907066
100086178438492
100056860744054
100069725054736
100014808582985
100014018888083
100053952871733
100013897121021
100025772821707
100052249943605
100004705307612
100053593913204
100033619806875
100047268082962
100021320419110
100007681755861
100043738728136
100081652991412
100033191509019
100073356797448
100015020687321
100013321779974
100026909268866
100051939380453
100015034903387
100028154955243
100011545056408
100024378912999
100077547259827
100024274442495
100016710124764
100011414134554
100032459776667
100028461549342
100049016626526
100093341002077
100017998785560
100027235120698
100089785321800
100052768963670
100082899656627
100060581318991
100026725501798
100064747062220
100042183014103
100084984076390
100018657444232
100025824495713
100010886072923
100068988172986
100084016987635
100023981827710
100039306222448
100025589498192
100054490341166
100042445627560
100011371801090
100066450305095
100036472114482
100011034215239
100071147052213
100069792411523
100022498335591
100050984803656
100014475787142
100041633209173
100048963360332
100057981285699
100022183995410
100089745176757
100079784385848
100027874410727
100054706219137
100014196373099
100025157632522
100023384204635
100024005633651
100013835299317
100055088434066
100027680210334
100091081690618
100012112788199
100085078338005
100078668766667
100079898823223
100039583986984
100064242313186
100029523194410
100083798196246
100049354151172
100009925930000
100079210308542
100082635376144
100022577171213
100075937070050
100077802618181
100067857791093
100023719036946
100077083595744
100034958384171
100048200237784
100007072816185
100010202868014
100055332154775
100041660251190
100026619639196
100012749408857
100010562380682
100085697380816
100043952300083
100063934802786
100014168923116
100033755059208
100016888961734
100048306849433
100040618171442
100051044682342
100056877734170
100027055401935
100031820528533
100013503072392
100046711162034
100053126168399
100009444423064
100024824392028
100025260308747
100030758232091
100052558982049
100014197485399
100026164206110
100017415460836
100042764744679
100020151012239
100026665878372
100028133479627
100008379858583
100072930705004
100024991598440
100065503878257
100057212591540
100082008111158
100057131187115
100023379080115
100056354240897
100017159416131
100037713180615
100051489676206
100012901537684
100025552894760
100010798127440
100032335313777
100071092938686
100027009402129
100077598666437
100029520223329
100012941586246
100014353694896
100026498821283
100088673659702
100024729525469
100087440906983
100034751331900
100011176093376
100089649934885
100015214209733
100030156362833
100007614315806
100074376040911
100018059856830
100054653449226
100016237152231
100028363295290
100030823243174
100024007813074
100016129518274
100041013642483
100012469082700
100069719021439
100011421128134
100010201961217
100025885129704
100023468632525
100082746185436
100013173396234
100080486275277
100039546435489
100044515521094
100052349634121
100022505298588
100044163436972
100012088363158
100017133011139
100006152806222
100010615742672
100074135796216
100009901503548
100027870315125
100045884946456
100036322070147
100067634197305
100041507540514
100003598494698
100031707972048
100015238682079
100036288904934
100008686901104
100029047141764
100087167600790
100011253994665
100095270275996
100053085769486
100068867402530
100074950016245
100030078431532
100044882052034
100045238892744
100041156763936
100052155550968
100014493846140
100015004662081
100073889407274
100013979162108
100064810971548
100063920980002
100042587561538
100014247096142
100046879786674
100022719917577
100018002305563
100081076597234
100077299950533
61552815530278
100016225423212
100005484333016
100051320827722
100006078131068
100077351331535
100015033421921
100091866010512
100025787024859
100030256752366
100044804865357
100029669582138
100027677085559
100028212794734
100024853590313
100056841223257
100028417222568
100066607057135
100025785227027
100018376930305
100078685330924
100033037254058
100053342073965
100034772165549
100009754488356
100014496151599
100047737029672
100014666562368
100029742559261
100040897352382
100011621015845
100043022804047
100046248692997
100023517400054
100077320911612
100013486360008
100052619351922
100055434810260
100050102169232
100022841810972
100024015230477
100023580504340
100060855319869
100023546857573
100014089454372
100070997625579
100026002875610
100018781350102
100048696369198
100079242693149
100029179992664
100055503966183
100043224710434
100056558436667
100030203780943
100055797897033
100047096000787
100032607500389
100013705602641
100074182623677
100042414577010
100023833552507
100032469092751
100010026427065
100007344498624
100013225848167
100023015205028
100024905700645
100072779687270
100087493067303
100011417952670
100027573915302
100065727727385
100036832867174
100029353963488
100015758911955
100078256050736
100071167452401
100024115841184
100026590009950
100027410172319
100030154741466
100053082611054
100028057772190
100093469705148
100045148700314
100026128782281
100027574724153
100069553687459
100023833063705
100035787758692
100047208578984
100024689991774
100077924840940
100014144942712
100022608427625
100064920452556
100025123149126
100009180903432
100068220196305
100005205765037
100023569281401
100050849652461
100028510668499
100035296161770
100028436268228
100023423034317
100057612670400
100023255990380
100015356533391
100027712490634
100024556692205
100008892737957
100085044565443
100009682366482
100039990192294
100077770714506
100064424071573
61552793465177
100012467893048
100028803370370
100069951616542
100027509243115
100050228773367
100010688970699
100023873780553
100054593868233
100010894008595
100052725613554
100070045476189
100085909973222
100044920875479
100009662472605
100022036242878
100073469017968
100006456961320
100024659123996
100068028494494
100022231997679
100054602229339
100012261753495
100024686461813
100030782053255
100094610750227
100038023711407
100027986140654
100073147516307
100046254337727
100030940846358
100018666880288
100083648936427
100051970419995
100047094653702
100053230163280
100028944944302
100008136314799
100011339163268
100009157118100
100079156507941
100069191117279
100028619702308
100027114997712
100033699044248
100051470262284
100054906834481
100051013133316
100029841074070
100032651471468
100088150383998
100013690155640
100047425513090
100008365202883
100026558688722
100076011319074
100088710645086
100015998285011
100082641970331
100028215166187
100078447914467
100023162264629
100067300013457
100014563534251
100020891089412
100070203500062
100062142525666
100011531477258
100023029026803
100089072353698
100016564486950
100072503236207
100041109673981
100088052875454
100016458342489
100054758952714
100039955296364
100010165747879
100045749589173
100009847273697
100058562919060
100086829753901
100013981746934
100089820129399
100032108559996
100012895786952
100035057890862
100049180440886
100025407135718
100025245485237
100024557199085
100062687763745
100024057832065
100010063877826
100014611779209
100050700550620
100059307890200
100010120713134
100048182163157
100015844836690
100050924506478
100013029285187
100023080876545
100026630821727
100089452783763
100040024960327
100015873214814
100045955360865
100026442463968
100033682481488
100031828050243
100065397231354
100041809155382
100040736753264
100029985840274
100027507578970
100044126017053
100042054216377
100035563274393
100092264752482
100069100224717
100041320913273
100011710206286
100063306037194
100087639556030
100030256844914
100034543821167
100075278634053
100040778256707
100028452782127
100040958948443
100053491302512
100052100103640
100081808210126
100047112408785
100055927429301
100071252565050
100054384554056
100025733410918
100033364850416
100039254502986
100028097867962
100088873055564
61572393573552
100088888497525
100068840791032
100041053267869
100042106122849
100058300306541
100073883294711
100074762623306
100051256552245
100066198736285
100015226569902
100058045877238
100054219470483
100060207324768
100081521334532
100025824932760
100078107603720
100060174469045
100046114909741
100014226992345
100022963703917
100026280407477
100036106592298
100026472405949
100045319598364
100007713979330
100090744775038
100086376246567
100072025807739
100012260731217
100045788113628
100065811453630
100028923061090
100049977617008
100092061847089
100061440543125
100006968165980
100005214706768
100055655628287
100069606752099
100022637681662
100057145004356
100084146918300
100090738684583
100015450540929
100013445144357
100073420721418
100046861843953
100009236916793
100089230801207
100015798061203
100010676858633
100031458290165
100054269717813
100023557269104
100058209250189
100022860201616
100077748800614
100071037874798
100030416681476
100005318236523
100013890697068
100026652002779
61582438760064
100023372593501
100052370241177
100008179380520
100010273264641
100019239093762
100033799454902
100082967150341
100009981197221
100070685900506
100060381766210
100094504513215
100043735697595
100082993406973
100089799468560
100025926519076
100081270616402
100053609613842
100012172186282
100014596003665
100052383499183
61554766944684
100025187352215
100090531017290
100076178785849
100025085299895
100024549906383
100012937020373
100011344172824
100052195042052
100068775639590
100012051673988
100033365314495
100062267971861
100022453663012
100011541457262
100012917347256
100074622363057
100071541475190
100022268912856
100031851650825
100022450574433
100078995196864
100086304293928
100041100660046
100022277838913
100089597141969
100024738226421
100049930779856
100086897835331
100083659586328
61551389601143
100027656901506
100050626396906
100007477698160
100038925884290
100045348282021
100042909639684
100037023465832
100012702275532
100040852081054
100016412911543
100041261543803
100022967913444
100012290410445
100013136269339
100012353434269
100039001492717
100079057573196
100025725240095
100034549294618
100054626355517
100038322886687
100011516373882
100006371417479
100015876041842
100040025026967
100066538335432
100050650006351
100082034113043
100073167063004
100033776558544
100040691748323
100048750761216
100091982475261
100088034042998
100011745123894
100012372877067
100024980913576
100018603378161
100036679273289
100013383827130
100038141479068
100070833648194
100089914426333
100080435868266
100020895277994
100021448069592
100022248289357
100046193385207
100074269802383
100088530482343
100074781150889
100012939977641
100045930270530
100089952608499
100059635181848
100040322527659
100030236952386
100085959780683
100011741971896
100067352417473
100008520280726
100044951031131
100081457022806
100012719560499
100092852956640
61551489377515
100082142361691
100011757851426
100091408723200
100012322921111
100080370705303
100010386792918
100012785742636
100047388099791
100014872902005
100057847141673
100071748498823
100022970625367
100070835374551
100051471562368
100023247302644
100011337368076
100051178126469
100012347642151
100074438044860
100015002023543
100010834275606
100035844152155
100052260907314
100087039518322
100052255573296
100057122301435
100013275393103
100051185349644
100012935943932
100023163952573
100009152928068
100006335374660
100044596054554
100021463665371
100021323768436
100012443288271
100051728980189
100075919890014
100054854319272
100049086483218
100008444165068
100077696581875
100092559134625
100086162691694
100038856138664
100013225898649
100053016193724
100015885280504
100037409252759
100011872234954
100013647031384
100069422686562
100040618302152
61550781067878
100087563208258
61555369543331
100086130206866
61557405156463
100011713922479
100052656871983
100044814943114
100037530459464
100052242061248
100027702259488
100023695294494
100072745592768
100027424610383
100050719280649
100022592763800
100029939048952
100040502822317
100027800536229
100043161232473
100083581995517
100068580196372
100075267288354
100017936710152
100025115920709
100014954135585
100073719108523
100084074824613
100086436737531
100054346512201
100050180930770
100080239522083
100068305786748
100014087444610
100010775707310
100082293372135
100067165629215
100022301658264
100085310793165
100042228092522
100080502271427
100027579300923
100079996017205
100011137086719
100081527047108
100078900521081
100011204044336
100024006903360
100065335787038
100047303444131
100036523507502
100015130479580
100042022260925
100081242550988
100049065244537
100006489441128
100038656065611
100068996734869
100028316558489
100078776209332
100050742885505
100067454182583
100009271945411
100089011546306
100069950635643
100027039618595
100024667191185
100012076603444
100026215293235
100075132755901
100050712263509
100050427413284
100025290173470
100009190899443
100008540824971
100020065066540
100050692112576
100017669282390
100014894026918
100018850696992
100087676340390
100064973964463
100010219961207
100091864731799
100033945315671
100014582568565
100030177735889
100057791121078
100011524389745
100048878389854
100012855091198
100093133104946
100085672597481
100057707780854
100051129037227
100073718177426
100074755756346
100082663984069
100009415305447
100014108885694
100018428033322
100015743611084
100023778706803
100040572125931
100090240411371
100086934682893
100077758742508
100019705445193
100068794656559
100088496317488
100041009582201
100076315061091
100051131288429
100082639352182
100023887201308
100026083478811
100026621341546
100094047211600
100040068095046
100013315087757
100019448316317
100068423853993
100088384685562
100029547920898
100039418174879
100011701463444
100030241447914
100054804353047
100078885851548
100070240271581
100021889352411
100078839152353
100027276674160
100027694786045
100009724219155
100040735455774
100044652701097
100008052857514
100059501169520
100071808827014
100054316878597
100010725674882
100010819271013
100010701708091
100092331744606
100094436374911
100065872577375
100011386720312
100017887689698
100031798342248
100081820119532
100017041059285
100009595669706
100027033740174
100010480269793
100007193163523
100091304153115
100021826872088
100094211685421
100065162115356
100037733289389
100018554734822
100053748667335
100036837168526
100011419287611
100072837610252
100043989484870
100016503816093
100034206970079
100047919677426
100064161314198
100024082010145
100008588319600
100025034573231
100014730510640
100068060444768
100034660874242
100085907380804
100008830873559
100052322254222
100062056151012
100043406801866
100014711260948
100074089472020
100088078723840
100055884373661
100011717993984
100022844449412
100010597173288
100010961884459
100044401300656
100029535100744
100082686043354
100008824665646
100030869384375
100046100834942
100009829901074
100085158511312
100092008706950
100024045744251
100024216398241
100043120581583
100028938680262
100009756465510
100051783229732
100068192780573
100030164897096
100049181781034
100013435427101
100080630467050
100088129575131
100037887060122
100029209171965
100048328793238
100039217662161
100009181522226
100067469389785
100010609423959
100033906911545
100029076829902
100083553638359
100021631653649
100039366487872
100026813562857
100071263362705
100069381938849
61550640060945
100005558743798
100009503983024
61565094951823
100023918912814
100048957163807
61565983052208
100015274687259
100034482802912
100022369836417
100043312925678
100088793565953
100069561451602
100013812612374
100047527020186
61574878144349
100019523973102
100007553986807
100008180379201
100040625504833
100049936235872
100046104639247
100009046581566
100036656508236
100090902875687
100044879915459
100013421025582
100009012328421
100039916568648
100077013994395
100052083003487
100039050239245
100038151638275
100069264097414
100010037980720
100048647205441
100088449011739
100029687077739
100005404455060
100061250709537
100051244214331
100027568533778
100093835848177
61551046543090
61551785533110
100092308406586
100036973395731
100058415476709
100015682836911
100049380699467
100031021536991
100037142452277
100002650703486
100008537353739
100044626517635
100021627013105
100002306930066
100000868540632
100049903839990
100043427220587
100049626605480
100031961116405
100043913743884
100025154492657
100025315846045
100063643261012
100037115483704
100059737773339
100081673744673
100023018656946
100052533093790
100024495881310
100030417290704
100052504473434
100025265252997
100059610948084
61580830432386
100028380219980
100047000304149
100056063205103
100053416262448
100039517628763
100009327637270
100005331763910
100049784012622
100066564880592
100009248902530
100064330030086
61578252665649
100045924110602
100086611890246
100024805779745
100042486731621
100005394001484
100066338650097
100031821530225
100013314336929
100038925774043
100039062626749
100067169856376
100045670662106
100060500992981
100054068563192
100045533718655
100014129139873
100009648750268
100013104367674
100009641828393
100076295741881
100045750450646
100031452870602
100084235327785
100048770808367
100080064943387
100006343476808
100005166363730
100019487033372
100054218856415
61559196214892
100047589240970
100023859555956
100062086243298
100085099700409
100015753549991
100032972687114
100060251201476
100043266080025
100009815043646
100052820167182
100093620126134
100030099079163
100088719051779
61560109469584
61555689149353
100025546290107
100028225476358
100086908555568
100016252870000
61584683526785
100072014522023
100034039505875
100038786228318
100081460831068
100060624039372
100073939749321
61550298674724
61584920454994
61572905285544
100086551312307
100004969423483
100052641650818
100076436520364
100082979004407
100062588610634
100027504074096
61570079956829
100073322433461
61555028072133
61550182116050
100009062580238
100025605090261
100030989721140
100057190419751
100090727592322
100044154019720
100084909396520
100021908266388
61565923629889
100057188462971
100013170768599
100008655483800
61581948208388
61561750437655
100076332491207
100042294471328
100006850301922
100029357040887
100021880987227
100005477493566
100015491237965
100087526476990
61566140986509
100029886441289
100070281304366
100055307902206
100074899137190
100050518965036
100091659559929
100058557725407
100077300986191
100078213384557
100057272572662
100060762293741
100039523590236
100043046564464
100014287936701
100044785604433
100069417993005
61562100118535
100063044480428
100083704634389
61551037187903
        </textarea>

        <div style="height:10px"></div>
        <label class="muted">Danh sách người (phân tách bằng dấu phẩy):</label>
        <input id="people" type="text" value="hoàng nam,nguyễn hương,việt anh,quang huy,tô lâm, phạm văn, đức dương, phan kiên, thiện trí, khẩn, long  " />

        <div class="controls">
          <button id="distribute">Phân đều</button>
          <button id="clear" class="small">Xóa phân bố</button>
          <button id="copyAll" class="small">Sao chép toàn bộ JSON</button>
          <button id="exportCsv" class="small">Xuất CSV</button>
          <div style="flex:1"></div>
        </div>

        <div style="margin-top:12px" class="muted">Bác Hồ đã nói "Không có việc gì khó, chỉ sợ lòng không bền, đào núi và lấp biển, quyết chí ắt làm nên"</div>
      </div>

      <div class="card">
        <h3>Kết quả phân bổ</h3>
        <div id="summary" class="muted">Chưa phân bổ</div>
        <div style="height:12px"></div>
        <div id="assignments" class="assignments"></div>
      </div>
    </div>

  </div>

  <script>
    // Utility
    function parseUIDs(text){
      // split on whitespace or commas
      return text.split(/\s+|,+/).map(s=>s.trim()).filter(Boolean);
    }
    function parsePeople(text){
      return text.split(/,+/).map(s=>s.trim()).filter(Boolean);
    }

    function distribute(uids, people){
      // ensure stable distribution even if fewer people than uids or vice versa
      const n = people.length;
      const result = {};
      people.forEach(p=> result[p]=[]);
      if(n===0){ return result; }
      // round-robin assignment
      for(let i=0;i<uids.length;i++){
        const p = people[i % n];
        result[p].push(uids[i]);
      }
      return result;
    }

    function render(assignments){
      const container = document.getElementById('assignments');
      container.innerHTML = '';
      const people = Object.keys(assignments);
      let total=0; let min=Infinity,max=-Infinity;
      people.forEach(p=>{
        const list = assignments[p];
        total += list.length;
        min = Math.min(min, list.length);
        max = Math.max(max, list.length);
      });
      if(people.length===0){ document.getElementById('summary').textContent = 'Không có người để phân bổ'; return; }
      document.getElementById('summary').textContent = `Tổng UID: ${total} — Người: ${people.length} — mỗi người nhận: ${min} đến ${max}`;

      people.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'person-card';
        const h = document.createElement('h3');
        h.textContent = `${p} (${assignments[p].length})`;
        card.appendChild(h);

        const btns = document.createElement('div'); btns.className='tools';
        const copyBtn = document.createElement('button'); copyBtn.className='small'; copyBtn.textContent='Sao chép';
        copyBtn.onclick = ()=>{ navigator.clipboard.writeText(assignments[p].join('\n')).then(()=> alert('Đã sao chép')) }
        const exportBtn = document.createElement('button'); exportBtn.className='small'; exportBtn.textContent='Xuất CSV';
        exportBtn.onclick = ()=>{ downloadCSV([[ 'name','uid' ], ...assignments[p].map(u=>[p,u])], `${p.replace(/\s+/g,'_')}.csv`) }
        btns.appendChild(copyBtn); btns.appendChild(exportBtn);
        card.appendChild(btns);

        const pre = document.createElement('div'); pre.className='uid-list'; pre.textContent = assignments[p].join('\n');
        card.appendChild(pre);
        container.appendChild(card);
      });
    }

    function downloadCSV(rows, filename){
      const lines = rows.map(r=> r.map(cell => '"' + String(cell).replaceAll('"','""') + '"').join(',')).join('\n');
      const blob = new Blob([lines], {type:'text/csv;charset=utf-8;'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      link.remove();
    }

    // DOM hookups
    document.getElementById('distribute').addEventListener('click', ()=>{
      const uidsRaw = document.getElementById('uids').value;
      const peopleRaw = document.getElementById('people').value;
      const uids = parseUIDs(uidsRaw);
      const people = parsePeople(peopleRaw);
      const assignments = distribute(uids, people);
      render(assignments);
      // store latest to window for export/copy
      window.latestAssignments = assignments;
    });

    document.getElementById('clear').addEventListener('click', ()=>{
      document.getElementById('assignments').innerHTML = '';
      document.getElementById('summary').textContent = 'Đã xóa phân bổ';
      window.latestAssignments = null;
    });

    document.getElementById('copyAll').addEventListener('click', ()=>{
      if(!window.latestAssignments){ alert('Chưa có phân bổ. Bấm Phân đều trước'); return; }
      navigator.clipboard.writeText(JSON.stringify(window.latestAssignments, null, 2)).then(()=> alert('Đã sao chép JSON'))
    });

    document.getElementById('exportCsv').addEventListener('click', ()=>{
      if(!window.latestAssignments){ alert('Chưa có phân bổ. Bấm Phân đều trước'); return; }
      // combine into rows [name,uid]
      const rows = [['name','uid']];
      Object.entries(window.latestAssignments).forEach(([name,uids])=>{
        uids.forEach(u=> rows.push([name,u]));
      });
      downloadCSV(rows, 'phan_bo_uid.csv');
    });

    // auto-distribute on load
    document.getElementById('distribute').click();
  </script>
</body>
</html>